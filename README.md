# Plot Director

Plot Director is a process that consumes plotter commands from a text file generated by 
[OPENRNDR](https://github.com/openrndr/openrndr) and the add-on feature 
[OPENRNDR Plot](https://github.com/nfletton/openrndr-plot) and drives an AxiDraw/NextDraw 
plotter via its Python API

## Features
- Executes [NextDraw Python API](https://bantam.tools/nd_py) commands contained in a text file
- Supports definition of reusable sets of API commands for operations such a paintbrush dipping and washing. 
- Notification of plot completion via a webhook
- Pausing plots for pen color change

## Usage
To use, create a Python virtual environment and run `pip install -r requirements.txt` to install 
required packages (currently only the NextDraw API)

To run Plot Director: 
```shell
python plot_director.py <path to command file> <optional webhook URL>
```

For example, to run one of the included command file examples from 
this directory in a Linux terminal, the run command would be:
```shell
python plot_director.py command_examples/pendown_penup.txt https://ntfy.sh/<your topic> 
```
Note: It is best not to run in a Pycharm terminal window, even the New Terminal Beta,
as the console output is less usable.

## Command Input File Format
Sample input files can be found in the [command_examples](command_examples) directory.

A command file consists of:
- **Comments**  
  Any line starting with a `#` is interpreted as a comment.
- **NextDraw Interactive API Options**  
  Any line beginning with `options ` is interpreted as an 
  [API Option](https://bantam.tools/nd_py/#setting-options) and 
  results in a call to the respective API call 
  e.g. `options pen_pos_down 30` results in a [call to](https://bantam.tools/nd_py/#pen_pos_down).
- **NextDraw Interactive API Functions**  
  Any line beginning with the name of an 
  [API Function](https://bantam.tools/nd_py/#functions-interactive)
  results in a call to the respective API call  
  e.g. `draw_path [[20.0,20.0],[190.0,20.0],[190.0,128.0],[20.0,128.0],[20.0,20.0]]`
  results in a [call to](https://bantam.tools/nd_py/#draw_path).
- **Pause Command**  
  Any line beginning with `pause ` causes processing of further commands to halt until the 
  keyboard character 'c' is pressed to resume the plot. Any characters after the command name
  are interpreted as a message that is sent to the console and the optional webhook
- **Reusable Command Sequences**  
  Lines starting with `def ` define reusable blocks of API commands. 
  These can be useful where repeated sequences of commands are required for 
  tasks such as reloading or washing a paintbrush in a well. A simple definition
  looks like `def repeat_me penup | moveto 100 100 | pendown | lineto 120 120`.
  In this example the definition would be called with the line `repeat_me`.
  

## Feature Wishlist
- pretty up the console output either with the existing curses package or urwid
- ability to halt a plot at any point and restart plot at another time from the halt point
- display of plot progression
  - distance traveled relative to total distance
  - time so far relative to total time estimate
- logging for command processing progression
- improved commandline option processing


